<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transforming data using textttOAVI · AVI.jl</title><meta name="title" content="Transforming data using textttOAVI · AVI.jl"/><meta property="og:title" content="Transforming data using textttOAVI · AVI.jl"/><meta property="twitter:title" content="Transforming data using textttOAVI · AVI.jl"/><meta name="description" content="Documentation for AVI.jl."/><meta property="og:description" content="Documentation for AVI.jl."/><meta property="twitter:description" content="Documentation for AVI.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AVI.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../basics/">How does it work?</a></li><li><span class="tocitem">Obtaining a transformation</span><ul><li><a class="tocitem" href="../how_to_run/">Obtaining a transformation</a></li><li class="is-active"><a class="tocitem" href>Transforming data using <span>$\texttt{OAVI}$</span></a><ul class="internal"><li><a class="tocitem" href="#Choosing-the-right-transformation"><span>Choosing the right transformation</span></a></li><li><a class="tocitem" href="#Applying-the-transformation"><span>Applying the transformation</span></a></li></ul></li><li><a class="tocitem" href="../docs_custom_oracle/">Custom Oracles</a></li><li><a class="tocitem" href="../docs_vca_transformation/">Transforming data using <span>$\texttt{VCA}$</span></a></li></ul></li><li><a class="tocitem" href="../print_polynomials/">Printing polynomials</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../reference/0_reference/">API Reference</a></li><li><a class="tocitem" href="../reference/1_algorithms/">Algorithms</a></li><li><a class="tocitem" href="../reference/2_oracles/">Oracles</a></li><li><a class="tocitem" href="../reference/3_border/">Border construction</a></li><li><a class="tocitem" href="../reference/4_terms_and_polys/">Terms and polynomials</a></li><li><a class="tocitem" href="../reference/5_auxiliary_funcs/">Auxiliary functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Obtaining a transformation</a></li><li class="is-active"><a href>Transforming data using <span>$\texttt{OAVI}$</span></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transforming data using <span>$\texttt{OAVI}$</span></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ZIB-IOL/AVI.jl.git" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ZIB-IOL/AVI.jl/blob/main/docs/src/docs_oavi_transformation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Transforming-data-using-\\texttt{OAVI}"><a class="docs-heading-anchor" href="#Transforming-data-using-\\texttt{OAVI}">Transforming data using <span>$\texttt{OAVI}$</span></a><a id="Transforming-data-using-\\texttt{OAVI}-1"></a><a class="docs-heading-anchor-permalink" href="#Transforming-data-using-\\texttt{OAVI}" title="Permalink"></a></h1><p>Finding the right transformation for your data with <span>$\texttt{OAVI}$</span> is heavily tied to the vanishing parameter <span>$\psi$</span>. As previously stated, <span>$\texttt{OAVI}$</span> terminates after having constructed polynomials of degree</p><p class="math-container">\[D = \lceil -\log(\psi)/\log(4) \rceil,\]</p><p>so tweaking the <code>psi</code> parameter is advised when searching for the best transformation. Below you can find a figure roughly indicating the influence of <span>$\psi$</span> on the degree <span>$D$</span>. If you have some prior knowledge about the underlying structure of your data and can somewhat restrict the polynomial degree you need, limiting the range of <span>$\psi$</span>&#39;s one tests can help avoid unnecessarily long runtime.</p><p><img src="../oavi_poly_deg.png" alt="Degree of terms"/></p><h2 id="Choosing-the-right-transformation"><a class="docs-heading-anchor" href="#Choosing-the-right-transformation">Choosing the right transformation</a><a id="Choosing-the-right-transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-the-right-transformation" title="Permalink"></a></h2><p>Let&#39;s read in some data first. To keep it general we will create some small random .csv file but feel free to read in your favorite data set.</p><pre><code class="language-julia hljs">using AVI
using DataFrames
using CSV
using Random

# create data
X = rand(100, 3)

# put it into a DataFrame
df = DataFrame(X, :auto)

# write it to &#39;example.csv&#39; in &#39;examples&#39; folder
CSV.write(&quot;examples/example.csv&quot;, df);

# read the data
read_df = CSV.read(&quot;examples/example.csv&quot;, DataFrame, types=Float64)

# convert DataFrame to Matrix
data = Matrix(read_df)</code></pre><p>Be sure that you read in your data with <code>Float64</code> as the type for your data as <code>fit_oavi</code> assumes the entries in the data matrix to be of type <code>Float64</code>.</p><p>Now we can start finding which <span>$\psi$</span> works best for us. Choose some values for <span>$\psi$</span> you want to test, for example <code>psis = [0.01, 0.005, 0.001, 0.0005]</code>. Then you loop through each <span>$\psi$</span>, check the e.g. classification error using your favorite classifier and choose the one that performs best.</p><pre><code class="language-julia hljs"># split train and test data
X_train, X_test = data[1:90, :], data[91:end, :]

# define psis
psis = [0.01, 0.005, 0.001, 0.0005]

# init best transform and best sets
best_transform, best_sets = nothing, nothing

# init error
error = Inf64

# loop psis
for psi in psis
    # transformation with current psi
    X_train_transformed, sets_train = fit_oavi(X_train; psi=psi)

    &quot;&quot;&quot;
    We do not provide a built-in classifier so feel free to use your favorite one here.
    if X_train_transformed !== nothing
        new_error = classifier(X_train_transformed, class_labels)
        if new_error &lt; error
            error = new_error
            best_transform, best_sets = X_train_transformed, sets_train
        end
    end
    &quot;&quot;&quot;
end</code></pre><h2 id="Applying-the-transformation"><a class="docs-heading-anchor" href="#Applying-the-transformation">Applying the transformation</a><a id="Applying-the-transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Applying-the-transformation" title="Permalink"></a></h2><p>Having found the transformation that works best on your training set, you would naturally want to apply this transformation to the data you want to classify. Since we already computed the borders and related values when constructing the transformation, we want to avoid unnecessary and expensive recomputations on testing data. For this we provide the function <code>apply_G_transformation</code> which takes as arguments <code>sets</code> and <code>X_test</code> and transforms <code>X_test</code> according to the transformation stored in <code>sets</code>. As to not get an error, we will compute <code>best_transform</code> and <code>best_sets</code> as some basic transformation.</p><pre><code class="language-julia hljs"># best transform and best sets
best_transform, best_sets = fit_oavi(X_train; psi=0.001)

# apply transformation to test set
X_test_transformed, sets_test = apply_G_transformation(best_sets, X_test)</code></pre><p>Note that <code>X_test</code> has to have the same second dimension as <code>X_train</code>, that is <code>size(X_train, 2) == size(X_test, 2)</code>, so be careful when applying the transformation to other data.</p><p>Lastly, to be safe, we check that the dimensions of the transformations indeed match the number of vanishing polynomials constructed by the algorithm.</p><pre><code class="language-julia hljs">println(&quot;Number of vanishing polynomials: &quot;, size(best_sets.leading_terms, 2))
size(best_transform, 2) == size(X_test_transformed, 2) == size(best_sets.leading_terms, 2)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_run/">« Obtaining a transformation</a><a class="docs-footer-nextpage" href="../docs_custom_oracle/">Custom Oracles »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 1 February 2024 13:48">Thursday 1 February 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
